"use strict";(self.webpackChunkestimate_powerup=self.webpackChunkestimate_powerup||[]).push([[831],{4305:function(t,n,e){e.d(n,{Eo:function(){return m},TO:function(){return _},Uo:function(){return W},V9:function(){return l},Vc:function(){return g},Wm:function(){return p},X8:function(){return k},bS:function(){return B},f5:function(){return C},kS:function(){return x},oc:function(){return h},qH:function(){return D},tm:function(){return J},w9:function(){return b},y7:function(){return f},zR:function(){return d}});var r=e(7762),u=e(1413),a=e(2982),i=e(8214),o=e(5861),c=e(8286),s=(0,i.Z)().mark(p);function f(t){var n=0;for(var e in t.workMinutes)n+=t.workMinutes[e];return n}function l(t,n,e){return n?0:(void 0===e&&(e=f(t)),(t.updatedEstimateMinutes||t.estimateMinutes)-e)}function p(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(0,i.Z)().keys(t.workMinutes);case 1:if((e.t1=e.t0()).done){e.next=7;break}return n=e.t1.value,e.next=5,{memberId:n,minutes:t.workMinutes[n]};case 5:e.next=1;break;case 7:case"end":return e.stop()}}),s)}function d(t){return 0!==t.updatedEstimateMinutes?t.updatedEstimateMinutes:t.estimateMinutes}function h(t,n){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,i.Z)().mark((function t(n,e){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,n.get(null!==e&&void 0!==e?e:"card","shared","estimate","null");case 3:if(t.t1=t.sent,null!==(r=t.t0.parse.call(t.t0,t.t1))){t.next=7;break}return t.abrupt("return",{estimateMinutes:0,updatedEstimateMinutes:0,workMinutes:{}});case 7:return t.abrupt("return",r);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(t,n,e){return w.apply(this,arguments)}function w(){return(w=(0,o.Z)((0,i.Z)().mark((function t(n,e,r){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.set(null!==r&&void 0!==r?r:"card","shared","estimate",JSON.stringify(e));case 2:return t.next=4,F(n);case 4:return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t){return y.apply(this,arguments)}function y(){return y=(0,o.Z)((0,i.Z)().mark((function t(n){var e,r,o,c,s=arguments;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=s.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=s[o];return void 0!==r&&0!==r.length||(r=["id"]),t.next=4,n.cards.apply(n,(0,a.Z)(r));case 4:return c=t.sent,t.next=7,Promise.all(c.map((function(t){return h(n,t.id).then((function(n){return(0,u.Z)((0,u.Z)({},n),{},{card:t})}))})));case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function x(t){return Z.apply(this,arguments)}function Z(){return(Z=(0,o.Z)((0,i.Z)().mark((function t(n){var e,u,a,o,c,s,p;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(n,"id","dueComplete");case 2:e=t.sent,u={estimateMinutes:0,updatedEstimateMinutes:0,workMinutes:0,remainingMinutes:0,deltaMinutes:0},a=(0,r.Z)(e);try{for(a.s();!(o=a.n()).done;)c=o.value,u.estimateMinutes+=c.estimateMinutes,s=f(c),u.workMinutes+=s,p=l(c,c.card.dueComplete),u.remainingMinutes+=p>0?p:0,u.updatedEstimateMinutes+=c.card.dueComplete?s:c.updatedEstimateMinutes||c.estimateMinutes,(c.card.dueComplete||s>c.estimateMinutes)&&(u.deltaMinutes+=c.estimateMinutes-s)}catch(i){a.e(i)}finally{a.f()}return t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(t){return M.apply(this,arguments)}function M(){return(M=(0,o.Z)((0,i.Z)().mark((function t(n){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,n.get("board","private","work","null");case 3:return t.t1=t.sent,null!==(e=t.t0.parse.call(t.t0,t.t1))&&(e.startDate=new Date(e.startDate)),t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function b(t,n){return N.apply(this,arguments)}function N(){return(N=(0,o.Z)((0,i.Z)().mark((function t(n,e){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.set("board","private","work",JSON.stringify(null!==e&&void 0!==e?e:null));case 2:c.W.emit();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(t){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)((0,i.Z)().mark((function t(n){var e,u,a,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,n.get("board","private","work_sessions","[]");case 3:t.t1=t.sent,e=t.t0.parse.call(t.t0,t.t1),u=(0,r.Z)(e);try{for(u.s();!(a=u.n()).done;)(o=a.value).startDate=new Date(o.startDate),void 0!==o.endDate&&(o.endDate=new Date(o.endDate))}catch(i){u.e(i)}finally{u.f()}return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function D(t,n){return E.apply(this,arguments)}function E(){return(E=(0,o.Z)((0,i.Z)().mark((function t(n,e){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.set("board","private","work_sessions",JSON.stringify(e));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(t){t.length>=10&&t.shift();var n={startDate:new Date,workMinutes:0};return t.push(n),n}function J(t,n){return A.apply(this,arguments)}function A(){return(A=(0,o.Z)((0,i.Z)().mark((function t(n,e){var r,u;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(n);case 2:return r=t.sent,void 0!==(u=r[r.length-1])&&void 0===u.endDate||(u=j(r)),t.next=7,e(u);case 7:return r[r.length-1]=t.sent,t.next=10,D(n,r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(t){return z.apply(this,arguments)}function z(){return(z=(0,o.Z)((0,i.Z)().mark((function t(n){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.get("board","shared","margin",.2);case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(t,n){return T.apply(this,arguments)}function T(){return(T=(0,o.Z)((0,i.Z)().mark((function t(n,e){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.set("board","shared","margin",e);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function B(t){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)((0,i.Z)().mark((function t(n){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.get("board","private","last_input_time",null);case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",new Date(e));case 5:return t.abrupt("return",null);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t,n){return P.apply(this,arguments)}function P(){return(P=(0,o.Z)((0,i.Z)().mark((function t(n,e){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.set("board","private","last_input_time",e);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function F(t){return G.apply(this,arguments)}function G(){return(G=(0,o.Z)((0,i.Z)().mark((function t(n){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O(n,new Date);case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},8286:function(t,n,e){e.d(n,{W:function(){return o}});var r=e(7143);var u,a,i=new(e.n(r)()),o=(u=i,a="work.current.changed",{on:function(t){return u.on(a,t),t},once:function(t){return u.once(a,t),t},off:function(t){return u.off(a,t),t},emit:function(t){return u.emit(a,t)}})},1868:function(t,n,e){e.d(n,{P:function(){return i}});e(2791);var r=e(184);function u(){return(0,r.jsxs)(r.Fragment,{children:["Served from: ",window.location.host]})}function a(){return(0,r.jsxs)(r.Fragment,{children:["Version: ","0.15.0"]})}function i(t){return(0,r.jsxs)("div",{className:t.className,children:[(0,r.jsx)("span",{className:"deploy-text",children:(0,r.jsx)(a,{})}),(0,r.jsx)("span",{className:"deploy-text",children:(0,r.jsx)(u,{})})]})}},8831:function(t,n,e){e.r(n),e.d(n,{default:function(){return m}});var r=e(2431),u=e(1675);var a=e(8214),i=e(5861),o=e(4305),c=e(5728),s=e(9697),f=e(3265);function l(){return(l=(0,i.Z)((0,a.Z)().mark((function t(n,e){var r,u,i,l,p,d,h,v,m;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.card("id","dueComplete");case 2:return r=t.sent,t.next=5,(0,o.oc)(n);case 5:return u=t.sent,t.next=8,(0,o.X8)(n);case 8:if(i=t.sent,l=(0,o.y7)(u),p=(0,o.V9)(u,r.dueComplete,l),0!==u.estimateMinutes||0!==l||(null===i||void 0===i?void 0:i.cardId)===r.id){t.next=13;break}throw n.NotHandled();case 13:return(null===i||void 0===i?void 0:i.cardId)===r.id&&(d=(0,s.Zd)(i.startDate),l+=d,p-=d),h=l>0?"| W: ".concat((0,c.JB)(l)):"",v=(0,f.M)({cardId:r.id,estimate:u,totalWorkMinutes:l}),m=r.dueComplete?0!==v?"| ".concat((0,f.W)({delta:v,short:!0})):"":"| R: ".concat((0,c.JB)(p)),t.abrupt("return",{text:"E: ".concat((0,c.JB)(u.updatedEstimateMinutes||u.estimateMinutes)," ").concat(h," ").concat(m),icon:e,color:r.id===(null===i||void 0===i?void 0:i.cardId)?"red":r.dueComplete?v>=0?"green":"yellow":void 0,refresh:10});case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(t,n){return[{dynamic:function(){return function(t,n){return l.apply(this,arguments)}(t,n.icon.light)}}]}var d={icon:{dark:(0,r.G)("/logo192.png",{absolute:!0}),light:(0,r.G)("/logo192.png",{absolute:!0})}};var h=e(2168),v=e(2577);console.log("initializing capabilities"),window.TrelloPowerUp.initialize({"board-buttons":function(t){return[{icon:{dark:(n=d).icon.dark,light:n.icon.light},text:"Estimate",callback:function(t){return t.modal({title:"Estimate",url:t.signUrl((0,u.u)("/board-page")),fullscreen:!1,height:400})},condition:"edit"}];var n},"card-back-section":function(t){return function(t,n){return{title:"Estimate",icon:n.icon.dark,content:{type:"iframe",url:t.signUrl((0,u.u)("/card-back-section",{absolute:!0})),height:210}}}(t,d)},"card-badges":function(t){return p(t,d)}}),(0,h.Q)();var m=v.default},2577:function(t,n,e){e.r(n),e.d(n,{default:function(){return o}});e(2791),e(657);var r=e(7861),u=e(7807),a=e(1868),i=e(184);function o(){return(0,i.jsx)("div",{className:"App",children:(0,i.jsxs)("header",{className:"App-header",children:[(0,i.jsx)("img",{src:r,className:"App-logo",alt:"logo"}),(0,i.jsx)("p",{children:"This is the Estimate Trello Powerup welcome page."}),(0,i.jsx)(a.P,{}),(0,i.jsx)(u.F,{to:"/dummy",children:"Dummy page"}),(0,i.jsx)(u.F,{to:"/board-page",children:"Board page"}),(0,i.jsx)(u.F,{to:"/card-back-section",children:"Card back section page"})]})})}},7807:function(t,n,e){e.d(n,{F:function(){return i}});var r=e(1413),u=(e(2791),e(1675)),a=e(184);function i(t){return(0,a.jsx)("a",(0,r.Z)((0,r.Z)({},t),{},{href:(0,u.u)(t.to),children:t.children}))}},1675:function(t,n,e){e.d(n,{u:function(){return u}});var r=e(2431);function u(t,n){return(0,r.G)("?path="+t,n)}},9005:function(t,n,e){function r(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd";return n.replaceAll("yyyy",t.getFullYear().toString()).replaceAll("MM",(t.getMonth()+1).toString().padStart(2,"0")).replaceAll("dd",t.getDate().toString().padStart(2,"0")).replaceAll("hh",t.getHours().toString().padStart(2,"0")).replaceAll("mm",t.getMinutes().toString().padStart(2,"0")).replaceAll("ss",t.getSeconds().toString().padStart(2,"0"))}e.d(n,{p:function(){return r}})},9697:function(t,n,e){e.d(n,{HH:function(){return u},LZ:function(){return s},Zd:function(){return c},ne:function(){return i},oE:function(){return a},qG:function(){return o}});var r=e(5728);function u(t,n){return new Date(t.getTime()+(0,r.y2)(n))}function a(t,n){return(0,r.do)(function(t,n){return n.getTime()-t.getTime()}(t,n))}function i(t){return Date.now()-t.getTime()}function o(t){return i(t)/1e3}function c(t){return i(t)/1e3/60}function s(t,n){return(null===t||void 0===t?void 0:t.getTime())===(null===n||void 0===n?void 0:n.getTime())}},2168:function(t,n,e){e.d(n,{Q:function(){return a},b:function(){return i}});var r=e(9005),u="exit.datetime";function a(){window.addEventListener("pagehide",(function(t){localStorage.setItem(u,JSON.stringify(new Date))}));var t=i();console.log(u+": "+(t?(0,r.p)(t,"yyyy-MM-dd hh:mm:ss"):"null"))}function i(){var t=JSON.parse(localStorage.getItem(u));return t?new Date(t):null}},6733:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function evaluateMathExpression(expression){if(!/^[0-9.()+*-/]+$/.test(expression))return NaN;try{return eval(expression)}catch(error){return NaN}}__webpack_require__.d(__webpack_exports__,{K:function(){return evaluateMathExpression}})},5728:function(t,n,e){e.d(n,{JB:function(){return s},MG:function(){return o},do:function(){return d},fg:function(){return p},xZ:function(){return i},y2:function(){return l},yz:function(){return f}});var r=e(885),u=e(7762),a=e(6733),i=8;function o(t,n,e){var o=(0,r.Z)(n,2),c=o[0],s=o[1],f=function(t){if(t=(t=(t=t.replaceAll(" ","")).replaceAll(",",".")).toLowerCase(),!/^([^a-z]+[a-z]+)+$/.test(t))return NaN;var n,e=0,r=(0,u.Z)(t.matchAll(/([^a-z]+)([a-z]+)/g));try{for(r.s();!(n=r.n()).done;){var o=n.value,c=o[2];if(1!==c.length)return NaN;var s=void 0;if("m"===c)s=1;else if("h"===c)s=60;else{if("d"!==c)return NaN;s=60*i}var f=(0,a.K)(o[1]);if(isNaN(f))return NaN;e+=s*f}}catch(l){r.e(l)}finally{r.f()}return e<=0?NaN:e}(c);if(!isNaN(f)){var l=e(f);return s(""),l}t.alert({display:"error",message:"invalid input",duration:4})}var c={zero:"none",negative:"?",hoursPerDay:8};function s(t){return f(t)}function f(t){var n,e,r,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if(isNaN(t))return"NaN";if(t<0)return null!==(n=u.negative)&&void 0!==n?n:c.negative;if(0===t)return null!==(e=u.zero)&&void 0!==e?e:c.zero;var a=null!==(r=u.hoursPerDay)&&void 0!==r?r:c.hoursPerDay,i=Math.floor(t%60),o=Math.floor(t/60),s=o%a,f=Math.floor(o/a),l=0;t<1&&(l=Math.round(60*t),i=0);var p="";return f>0&&(p+=f+"d"),s>0&&(p+=s+"h"),i>0&&(p+=i+"m"),l>0&&(p+=l+"s"),p}function l(t){return 60*t*1e3}function p(t){return l(60*t)}function d(t){return t/1e3/60}},2431:function(t,n,e){function r(t,n){var e="/estimate-powerup"+t;return null!==n&&void 0!==n&&n.absolute?window.location.origin+e:e}e.d(n,{G:function(){return r}})},3265:function(t,n,e){e.d(n,{M:function(){return i},W:function(){return o}});var r=e(4305),u=e(9697),a=e(5728);function i(t){var n,e=null!==(n=t.totalWorkMinutes)&&void 0!==n?n:(0,r.y7)(t.estimate);return null!=t.currentWork&&t.currentWork.cardId===t.cardId&&(e+=(0,u.Zd)(t.currentWork.startDate)),t.estimate.estimateMinutes-e}function o(t){var n=t.delta,e=t.short;return n>=0?e?"S: "+(0,a.JB)(n):"Saved: "+(0,a.JB)(n):e?"S: -"+(0,a.JB)(-n):"Spent: "+(0,a.JB)(-n)}},657:function(){},7861:function(t,n,e){t.exports=e.p+"static/media/e.9f14f730419b76f670f5.png"}}]);
//# sourceMappingURL=831.d72d5678.chunk.js.map