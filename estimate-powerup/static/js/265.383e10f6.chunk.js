"use strict";(self.webpackChunkestimate_powerup=self.webpackChunkestimate_powerup||[]).push([[265],{4305:(t,e,n)=>{n.d(e,{EB:()=>u,Eo:()=>l,Hv:()=>i,TO:()=>M,Uo:()=>b,V9:()=>s,VS:()=>m,Vc:()=>v,Wm:()=>a,X8:()=>h,bS:()=>N,f5:()=>g,kS:()=>p,oc:()=>f,qH:()=>_,s9:()=>d,tm:()=>k,w9:()=>y,y7:()=>o,zR:()=>c});var r=n(8286);const i={estimateMinutes:0,updatedEstimateMinutes:0,workMinutes:0,workMinutesByMember:{},remainingMinutes:0,deltaMinutes:0};function o(t){let e=0;for(const n in t.workMinutes)e+=t.workMinutes[n];return e}function s(t,e,n){return e?0:(void 0===n&&(n=o(t)),(t.updatedEstimateMinutes||t.estimateMinutes)-n)}function*a(t){for(const e in t.workMinutes)yield{memberId:e,minutes:t.workMinutes[e]}}function*u(t){for(const e in t.workMinutesByMember)yield{memberId:e,minutes:t.workMinutesByMember[e]}}function c(t){return 0!==t.updatedEstimateMinutes?t.updatedEstimateMinutes:t.estimateMinutes}async function f(t,e){const n=JSON.parse(await t.get(null!==e&&void 0!==e?e:"card","shared","estimate","null"));return null===n?{estimateMinutes:0,updatedEstimateMinutes:0,workMinutes:{}}:n}async function l(t,e,n){return await t.set(null!==n&&void 0!==n?n:"card","shared","estimate",JSON.stringify(e)),await async function(t){!async function(t,e){await t.set("board","private","last_input_time",e)}(t,new Date)}(t),e}async function d(t,e,n){var r;const i=await t.member("id"),o=await f(t,n);await l(t,{...o,workMinutes:{...o.workMinutes,[i.id]:(null!==(r=o.workMinutes[i.id])&&void 0!==r?r:0)+e}},n),await k(t,(async t=>({...t,workMinutes:t.workMinutes+e})))}async function v(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];void 0!==n&&0!==n.length||(n=["id"]);const i=await t.cards(...n);return await Promise.all(i.map((e=>f(t,e.id).then((t=>({...t,card:e}))))))}async function p(t){return w(await v(t,"id","dueComplete"))}function w(t){const e={estimateMinutes:0,updatedEstimateMinutes:0,workMinutes:0,workMinutesByMember:{},remainingMinutes:0,deltaMinutes:0};for(const i of t){e.estimateMinutes+=i.estimateMinutes;const t=o(i);e.workMinutes+=t;for(const o in i.workMinutes){var n,r;null!==(r=(n=e.workMinutesByMember)[o])&&void 0!==r||(n[o]=0),e.workMinutesByMember[o]+=i.workMinutes[o]}const a=s(i,i.card.dueComplete);e.remainingMinutes+=a>0?a:0,e.updatedEstimateMinutes+=i.card.dueComplete?t:i.updatedEstimateMinutes||i.estimateMinutes,(i.card.dueComplete||t>i.estimateMinutes)&&(e.deltaMinutes+=i.estimateMinutes-t)}return e}async function m(t){const e=await t.list("id","cards"),n=[];for(const r of e.cards){const e=await f(t,r.id);n.push({card:r,...e})}return w(n)}async function h(t){const e=JSON.parse(await t.get("board","private","work","null"));return null!==e&&(e.startDate=new Date(e.startDate)),e}async function y(t,e){await t.set("board","private","work",JSON.stringify(null!==e&&void 0!==e?e:null)),r.W.emit()}async function M(t){const e=await t.get("board","private","work_sessions","[]"),n=JSON.parse(e);for(const r of n)r.startDate=new Date(r.startDate),void 0!==r.endDate&&(r.endDate=new Date(r.endDate));return n}async function _(t,e){await t.set("board","private","work_sessions",JSON.stringify(e))}async function k(t,e){const n=await M(t);let r=n[n.length-1];void 0!==r&&void 0===r.endDate||(r=function(t){t.length>=32&&t.shift();const e={startDate:new Date,workMinutes:0};return t.push(e),e}(n)),n[n.length-1]=await e(r),await _(t,n)}async function g(t){return await t.get("board","shared","margin",.2)}async function b(t,e){await t.set("board","shared","margin",e)}async function N(t){let e=await t.get("board","private","last_input_time",null);return e&&(e=new Date(e)),e}},8286:(t,e,n)=>{n.d(e,{W:()=>o});var r=n(7143);const i=new(n.n(r)()),o=(s=i,a="work.current.changed",{on:t=>(s.on(a,t),t),once:t=>(s.once(a,t),t),off:t=>(s.off(a,t),t),emit:t=>s.emit(a,t)});var s,a},9697:(t,e,n)=>{n.d(e,{HH:()=>i,LZ:()=>c,Zd:()=>u,ne:()=>s,oE:()=>o,qG:()=>a});var r=n(5728);function i(t,e){return new Date(t.getTime()+(0,r.y2)(e))}function o(t,e){return(0,r.do)(function(t,e){return e.getTime()-t.getTime()}(t,e))}function s(t){return Date.now()-t.getTime()}function a(t){return s(t)/1e3}function u(t){return s(t)/1e3/60}function c(t,e){return(null===t||void 0===t?void 0:t.getTime())===(null===e||void 0===e?void 0:e.getTime())}},6733:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function evaluateMathExpression(expression){if(!/^[0-9.()+*-/]+$/.test(expression))return NaN;try{return eval(expression)}catch(error){return NaN}}__webpack_require__.d(__webpack_exports__,{K:()=>evaluateMathExpression})},5728:(t,e,n)=>{n.d(e,{JB:()=>a,MG:()=>o,do:()=>l,fg:()=>f,xZ:()=>i,y2:()=>c,yz:()=>u});var r=n(6733);const i=8;function o(t,e,n){let[o,s]=e;const a=function(t){if(t=(t=(t=t.replaceAll(" ","")).replaceAll(",",".")).toLowerCase(),!/^([^a-z]+[a-z]+)+$/.test(t))return NaN;let e=0;for(const n of t.matchAll(/([^a-z]+)([a-z]+)/g)){const t=n[2];if(1!==t.length)return NaN;let o;if("m"===t)o=1;else if("h"===t)o=60;else{if("d"!==t)return NaN;o=60*i}const s=(0,r.K)(n[1]);if(isNaN(s))return NaN;e+=o*s}return e<=0?NaN:e}(o);if(isNaN(a))return void t.alert({display:"error",message:"invalid input",duration:4});const u=n(a);return s(""),u}const s={zero:"none",negative:"?",hoursPerDay:8};function a(t){return u(t)}function u(t){var e,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;if(isNaN(t))return"NaN";if(t<0)return null!==(e=i.negative)&&void 0!==e?e:s.negative;if(0===t)return null!==(n=i.zero)&&void 0!==n?n:s.zero;const o=null!==(r=i.hoursPerDay)&&void 0!==r?r:s.hoursPerDay;let a=Math.floor(t%60);const u=Math.floor(t/60),c=u%o,f=Math.floor(u/o);let l=0;t<1&&(l=Math.round(60*t),a=0);let d="";return f>0&&(d+=f+"d"),c>0&&(d+=c+"h"),a>0&&(d+=a+"m"),l>0&&(d+=l+"s"),d}function c(t){return 60*t*1e3}function f(t){return c(60*t)}function l(t){return t/1e3/60}},3265:(t,e,n)=>{n.d(e,{M:()=>s,W:()=>a});var r=n(4305),i=n(9697),o=n(5728);function s(t){var e;let n=null!==(e=t.totalWorkMinutes)&&void 0!==e?e:(0,r.y7)(t.estimate);return null!=t.currentWork&&t.currentWork.cardId===t.cardId&&(n+=(0,i.Zd)(t.currentWork.startDate)),t.estimate.estimateMinutes-n}function a(t){let{delta:e,short:n}=t;return e>=0?n?"S: "+(0,o.JB)(e):"Saved: "+(0,o.JB)(e):n?"O: "+(0,o.JB)(-e):"Overtime: "+(0,o.JB)(-e)}},7143:t=>{var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,r,o,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||t,s),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function s(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,i,o,s){var a=n?n+t:t;if(!this._events[a])return!1;var u,c,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,r),!0;case 4:return f.fn.call(f.context,e,r,i),!0;case 5:return f.fn.call(f.context,e,r,i,o),!0;case 6:return f.fn.call(f.context,e,r,i,o,s),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];f.fn.apply(f.context,u)}else{var d,v=f.length;for(c=0;c<v;c++)switch(f[c].once&&this.removeListener(t,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,e);break;case 3:f[c].fn.call(f[c].context,e,r);break;case 4:f[c].fn.call(f[c].context,e,r,i);break;default:if(!u)for(d=1,u=new Array(l-1);d<l;d++)u[d-1]=arguments[d];f[c].fn.apply(f[c].context,u)}}return!0},a.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var u=0,c=[],f=a.length;u<f;u++)(a[u].fn!==e||i&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}}]);
//# sourceMappingURL=265.383e10f6.chunk.js.map